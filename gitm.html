<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Ghost in the Machine</title>
<link rel="stylesheet" href="gitm.css">
</head>
<body>
<div id="entireChatThing" class="entireChatThing">
	<form id="chatForm">
	<!-- a div for the previous chat stuff -->
	<!-- use CSS to make her text blue and yours red? -->
	<!-- sometimes display a tiny GIF that looks like she's typing -->
	<!-- how do we make it asynchronous so that the player can say something while Abigail's thinking? -->
	<div id="chatWindow" class="chatWindow">
		<div id="chatHistory" class="chatHistory">
		</div>
		<br />
		<div><!-- Abby typing gif here, blank or animated of same size--></div>
	</div>
	<br />
	<!-- a text input for the player -->
	<input type="text" class="inputField"This id="inputText"></input>

	<!-- a submit button that grabs the contents of the text input and appends it to the div -->
	<!-- probably avoid actually submitting, just an onClick() to get the input -->

	<button id="submit" class="talkButton" name="Submit">Talk</button>
	</form>
</div>

<script type="text/javascript" src="gitm.json"></script>
<script type="text/javascript" src="gitm.js"></script>

<script type="text/javascript">



function setup(){
// Load app data (map, responses)
// Get cookie
// Set chat history
// Show greeting (start greeting? Most recent node? If most recent interaction is recent, do nothing)
}



function processInput(e) {
  e.preventDefault();
	g.playerInput = document.getElementById("inputText").value;
	let inputHTML = '<br /><span class="player">' + g.playerInput + '</span>';
	let chatHistoryDiv = document.getElementById("chatHistory");
	let chat = chatHistoryDiv.innerHTML + inputHTML;
	chatHistoryDiv.innerHTML = chat;
	chatHistoryDiv.scrollTop = chatHistoryDiv.scrollHeight; // = chatHistoryDiv.clientHeight;
	document.getElementById("inputText").value = "";
	setTimeout("chatReply(g.playerInput)", 1000);
}

function chatReply(input){
	let chatHistoryDiv = document.getElementById("chatHistory");
	let response;
	// if we're in the end node, we don't have to build a response anymore.
	response = '<br /><span class="computer">' + buildResponse(input) + '</span>';
	// get chat history

	// add response

	// write it to the global

	let chat = chatHistoryDiv.innerHTML + response;
	chatHistoryDiv.innerHTML = chat;
	chatHistoryDiv.scrollTop = chatHistoryDiv.scrollHeight;
	// change global state object
	// write cookie
}

let form = document.getElementById("chatForm");
form.addEventListener('submit', processInput);
setup();
</script>
</body>
</html>
